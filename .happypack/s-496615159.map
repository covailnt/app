{"version":3,"sources":["src\\refire\\resources.js"],"names":["initialized","handler","store","action","state","getState","currentProject","type","id","ref","database","orderByChild","equalTo","on","_v","value","forEach","sn","push","val","key","dispatch","sort","a","b","date"],"mappings":";;;;;;;;AAAA;;;;;;AAEA,IAAIA,cAAc,KAAlB;AACA,IAAMC,UAAU,SAAVA,OAAU,CAACC,KAAD,EAAQC,MAAR,EAAiB;AAC/B,MAAMC,QAAQF,MAAMG,QAAN,EAAd;AAD+B,MAExBC,cAFwB,GAENF,KAFM,CAExBE,cAFwB;;AAG/B,MAAGH,OAAOI,IAAP,IAAe,qBAAf,IAAyCD,kBAAkB,CAACN,WAA/D,EAA4E;AAC1EA,kBAAc,IAAd;AACA,QAAMQ,KAAKN,MAAMG,QAAN,GAAiBC,cAAjB,CAAgCE,EAA3C;AACA,QAAMC,MAAM,mBAASC,QAAT,GAAoBD,GAApB,CAAwB,WAAxB,CAAZ;AACAA,QAAIE,YAAJ,CAAiB,WAAjB,EAA8BC,OAA9B,CAAsCJ,EAAtC,EAA0CK,EAA1C,CAA6C,OAA7C,EAAsD,UAACC,EAAD,EAAM;AAC1D,UAAIC,QAAQ,EAAZ;AACAD,SAAGE,OAAH,CAAW,UAACC,EAAD,EAAM;AACfF,cAAMG,IAAN,cAAeD,GAAGE,GAAH,EAAf,IAAyBX,IAAIS,GAAGG,GAAhC;AACD,OAFD;;AAIAlB,YAAMmB,QAAN,CAAe;AACbd,cAAM,eADO;AAEbQ,eAAOA,MAAMO,IAAN,CAAW,UAACC,CAAD,EAAIC,CAAJ;AAAA,iBAChBD,EAAEE,IAAF,GAASD,EAAEC,IADK;AAAA,SAAX;AAFM,OAAf;AAMD,KAZD;AAaD;AACF,CArBD;;kBAuBexB,O","file":"resources.js","sourceRoot":"C:/Users/Ryan/Documents/dev/embark/covailnt","sourcesContent":["import firebase from './firebase'\n\nlet initialized = false\nconst handler = (store, action)=>{\n  const state = store.getState()\n  const {currentProject} = state;\n  if(action.type == 'SET_CURRENT_PROJECT' || (currentProject && !initialized)){\n    initialized = true;\n    const id = store.getState().currentProject.id\n    const ref = firebase.database().ref('resources')\n    ref.orderByChild('projectId').equalTo(id).on('value', (_v)=>{\n      let value = [];\n      _v.forEach((sn)=>{\n        value.push({...sn.val(), id: sn.key})\n      })\n      \n      store.dispatch({\n        type: 'SET_RESOURCES',\n        value: value.sort((a, b)=>(\n          a.date > b.date\n        ))\n      })\n    })\n  }\n}\n\nexport default handler"]}